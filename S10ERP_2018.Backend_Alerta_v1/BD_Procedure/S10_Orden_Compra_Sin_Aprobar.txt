USE [INTERFACES]
GO

/****** Object:  StoredProcedure [dbo].[S10_Orden_Compra_Sin_Aprobar]    Script Date: 02/03/2018 04:07:25 p.m. ******/
SET ANSI_NULLS ON
GO

SET QUOTED_IDENTIFIER ON
GO





-- =============================================
-- Author:		<Author,,Name>
-- Create date: <Create Date,,>
-- Description:	<Description,,>
-- =============================================
CREATE PROCEDURE [dbo].[S10_Orden_Compra_Sin_Aprobar]
	-- Add the parameters for the stored procedure here

AS
BEGIN
	-- SET NOCOUNT ON added to prevent extra result sets from
	-- interfering with SELECT statements.
	SET NOCOUNT ON;

    -- Insert statements for procedure here
Select oc.CodProyecto, oc.Proyecto, oc.CodOrden as NroOrden,CASE WHEN oc.TipoOrden='0' THEN 'Orden Compra' ELSE 'Orden Servicio' END as Tipo,oc.CodFormaDePago, oc.FORMADEPAGO, oc.CodMoneda, oc.MONEDA,
oc.ValorNeto,oc.CodEstado, oc.EstadoOC, oc.ProveedorRuc, oc.Proveedor,oc.LugarDeEntrega,CONVERT(varchar, oc.Fecha, 103) AS FechaOrden, CONVERT(varchar, oc.FechaEntrega, 103) AS FechaEntrega, 
oc.DescripcionProcedencia as Procedencia, cc.Descripcion as CentroCompra, oc.LugarDeEntrega, oc.CreacionUsuario, oc.ActualizacionUsuario,CONVERT(varchar, oc.FechaEnvioAprobacion, 100) AS FechaEnvioAprobacion ,
oc.UsuarioA, CONVERT(varchar, oc.FechaAprobacion, 100) AS FechaAprobacion, oc.Comprador, oc.MontoFacturado, oc.EstadoFacturado ,oc.Observacion
from NEXCOMS10.dbo.vw_02OrdenesDeCompra as oc inner join NEXCOMS10.dbo.CentroCompra as cc on oc.NroCC=cc.NroCC
where oc.CodEstado in ('01','06')

END



GO


